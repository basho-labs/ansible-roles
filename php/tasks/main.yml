---
- name: install php cli and needed extensions
  yum: name={{ item }} state=present
  with_items:
    - php-cli
    - php-pear
    - php-xml
    - php-pecl-xdebug

- name: Check if composer is installed
  stat: path=/usr/bin/composer
  register: composer

- name: Fetch composer
  shell: "curl -sS https://getcomposer.org/installer | /usr/bin/php chdir=/tmp"
  when: not composer.stat.exists

- name: Install it globally
  command: "/bin/mv -f composer.phar /usr/bin/composer chdir=/tmp"
  when: not composer.stat.exists
